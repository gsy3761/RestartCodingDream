# c的结构类型

### 结构类型

- 一个结构就是一个复合的数据类型

- 注意struct后面的大括号里面要有分号

- ```c
  struct 结构名
  {
  	各种变量名；
  }；
  ```

- 通常把结构体放在函数的外面，不依附于其他函数，就可以给各种函数使用

  - 如果定义在main函数里面，那么这一个结构体只能够给main函数使用

- 初始化结构

  - 使用结构类型定义出结构变量之后，可以使用 结构变量.结构变量内的成员来进行赋值

  - ```c
    struct 结构名
    {
    	各种变量名；
    }；
    struct 结构名 结构变量 = {1,2,3};
    struct date  date = {.month = 7, .year = 2014};
    //给的值填进去，没有给的填0
    ```

    - 数组的单元必须是同一类型的，但是结构的单元可以是不同的

      - 结构使用“ . ”运算符和名字访问成员

        - 比如

          ```c
          today.day
          student.firstName
          ```

      - 要访问整个结构，直接使用结构变量的名字；对于整个结构，可以做赋值，取地址，也可以传递给函数参数

        - ```c
          p1 = (struct point){5,10};
          //相当于p1.x = 5；p1.y = 10；属于强制类型转换
          p1 = p2；//相当于 p1.x = p2.x; p1.y = p2.y;
          ```

          - 数组变量是不可以的，因为数组变量是const的变量，数组初始化之后就不能等于另一个数组，但是结构可以

      - 结构指针

        - 注意：和数组不同，结构变量的名字并不是结构变量的地址，必须使用&运算符

        - ```c
          struct date *pDate = &today;
          ```

- 结构可以作为函数参数

  - 整个结构可以作为参数的值传入函数，也可以作为返回值
    - 这时候是在函数内新建一个结构变量，并复制调用者的结构的值，在函数里面作为参数是一个全新的结构，和数组不同
    
      ```c
      scanf("%i",&today.month);//%d匹配十进制，%i匹配八进制二进制十进制
      ```
    
      - 没有直接的方式可以一次性scanf一整个结构
    
    - 也可以返回一个结构，和数组不同；取成员的优先级高于取地址

- 解决方案（返回函数中操作过的结构）（因为传入的是结构的克隆体，和数组不一样）

  1. 创建一个临时的结构变量，然后返回这一个临时的结构变量，因为相同类型的结构可以直接整体赋值，但是数组不可以

     ```c
     struct point 
     {
     	int x;
     	int y;
     };
     struct point FuZhi (struct p)
     int main()
     {
     	struct point p1;
     	p1 = FuZhi();
     }
     ```

  2. 不传结构，传指针；c语言的函数传递是值的传递，函数要建立一个一样的结构，既费空间，又费时间

     - 结构变量本身不是地址，用&取出地址

       ```c
       struct point
       {
       	int x;
       	int y;
       }myPoint;
       struct point* FuZhi(struct point *p)
       {
       	scanf("%d",&p->x);
       	return p;
       }
       void outPut(struct point p)//在这边的p是结构变量，在main函数中的指针经过取值是传入这边的结构变量
       {
       	printf("%d",p.x);
       }
       int main()
       {
       	struct date *p = &myPoint;
       	(*p).x = 12;
       	p->x = 12;//和上面一句取地址的结果一样
       	FuZhi(&myPoint);
       	outPut(*FuZhi(&p));//使用结构指针函数还有一个好处是，可以嵌套在函数内
       }
       
       
       ```

- 结构中的结构

  - 结构数组

    ```c
    struct point p[100];
    struct point p[]={{1,2},{32,43}};
    printf("%d",p[0].x);
    ```

  - 结构中的结构

    - 结构中的类型可以是基础类型，也可以是另外的结构

      ```c
      struct dateAndPoint
      {
      	struct date date3;
      	struct point p3;
      }dp1;
      printf("%d",dp1.p3.x);
      ```


- 联合

  - union

  - sizeof（union...） = sizof（最大的成员变量）

  - 不同的变量占据相同的内存空间

  - 一个变量使用了，另一个变量就不能使用

  -  

    ```c
    union Demo
    {
    	int demo_1;
    	char demo_2;
    }Demo_it；
    ```

  -  任何变量占据的变量空间只有一个，同一时间只有一个成员是有效的，大小始终是他最大的成员

  - 初始化

    - 对union的第一个成员进行初始化

  - 大小端（通常用union的时候看字节排布）

    - x86是小端，也就是低位在前
    - 做文件读写的时候可能用到







