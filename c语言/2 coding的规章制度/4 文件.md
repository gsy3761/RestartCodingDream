# 文件

- 文件输入输出

  - 使用>和<做重定向

  - ```shell
    //shell
    ./test > 12.out//将产生的文件写入到12.out
    //可以使用more 12.out查看
    //使用cat > 12.out做写入
    ```

    - 使用<表示文件的输出，使用>表示文件的输出

  - 在stdio.h中有FILE

    - ```c
      //打开文件的标准代码
      FILE *fp = fopen("文件名","r");//打开成功返回1，失败返回0
      ```

      ![截屏2022-01-07 下午7.44.19](https://tva1.sinaimg.cn/large/008i3skNgy1gy5ci867n4j31fo0nqgno.jpg)

### 二进制文件

- 所有的文件最终都是二进制的

- 文本文件无非使用最简单的方式可以读写的文件，二进制文件是需要专门的程序来读写的文件，文本文件的输入输出是格式化，可能经过转码

  - 我们使用scanf就是扫描输入，把他们放到合适的地方去
  - 对应命令
    - more，tail，cat，vi

- 江湖情仇

  - Unix喜欢使用文本文件做数据存储和程序配置
    - 交互式终端的出现（shell）让人们喜欢使用文本和计算机交谈
    - Unix的shell提供了一些用来读写文本的小程序
  - WIndows喜欢用二进制文件
    - DOS是微软一开始做的，70年代末
    - 个人计算机是革命性的，是pioneer不是professional
    - DOS是草根文化，并不继承和熟悉UNIX文化
    - PC刚开始的时候能力有限，DOS能力更加有限，二进制更加接近底层
  - 各有千秋
    - 文本方便人类读写，而且跨平台，因为无论什么平台，文字拿出来人都能看懂
    - 文本的缺点
      - 程序的输入输出要进行格式化，scanf，printf是需要开销的，在计算机内部是4个字节的，要变成人能够读懂的字符串需要花时间
    - 二进制的缺点
      - 人类阅读困难，而且不跨平台
        - 比如int的大小不一致，大小端的问题
        - 在一台计算机上使用二进制写的文件，在另一台计算机上不一定正确
    - 二进制的优点
      - 输入输出是直接的，写进二进制的文件中是原封不动的写进去的，在写的过程中不需要做计算，在读的时候也是一样

  ### 程序为什么需要文件

  - 配置
    - UNIX使用文本，windows使用注册表
      - 比如窗口多大，字体是什么颜色
      - 注册表是一个很大的二进制文件，windwos里面所有的配置文件都写在这个里面，使用REG之类的编辑软件才能够编辑它
  - 数据
    - 稍微有点大的数据都放数据库
      - 有数据库的接口，能调用很容易
  - 媒体
    - 这个只能是二进制的，因为图片之类的不可能是文本的，不可能根据文字的描述画出文本
  - 现实
    - 没有人使用二进制文件一个个取出字节，做出图片。都是使用第三方库来读写文件，有现成写好的，调用一个函数，程序把二进制数据装载到内存中，之后把图片显示出来

### 二进制读写

- 实在要对二进制文件进行读写
  - size_t fread(void *restrict ptr, size_t size, size_t items,FILE *restrict stream);
  - Size_t write(const void *restrict ptr, size_t size, size_t items,FILE *restrict stream);
  - 注意FILE指针是最后一个参数，返回的是成功读写的字节数
- 为什么nitem
  - 因为对二进制文件的读写一般都是通过对一个结构变量的操作来进行的
  - 于是nitem就是用来说明这次读写几个结构变量

